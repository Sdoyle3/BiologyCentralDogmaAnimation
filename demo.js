Bridge.assembly("Demo",function(e,l){"use strict";Bridge.define("CellCycle.Animations",{statics:{methods:{basicAnimation:function(e,l,t,r){var n=setInterval(function(){e.System$Collections$IEnumerator$moveNext()?(System.Console.Clear(),System.Console.WriteLine(e[Bridge.geti(e,"System$Collections$Generic$IEnumerator$1$System$String$Array$Current$1","System$Collections$Generic$IEnumerator$1$Current$1")].join("\n"))):(clearInterval(n),setTimeout(r,t))},l)},helicaseAnimation:function(e){var l,t,r,n,i=0,C=new(Bridge.GeneratorEnumerator$1(System.Array.type(System.String)))(Bridge.fn.bind(this,function(){try{for(;;)switch(i){case 0:l=System.Array.init(9,null,System.String),t=Bridge.Int.clip32(Math.ceil(e.getSequence().length/4)),r=1+(Bridge.Int.mul(t,CellCycle.CellCycle.helixWidth)+12|0)|0,n=0,i=1;continue;case 1:if(n<r){i=2;continue}i=5;continue;case 2:for(var a=0;a<9;a=a+1|0)l[System.Array.index(a,l)]=(CellCycle.CellCycle.openedDisplay[System.Array.index(a,CellCycle.CellCycle.openedDisplay)].substr(0,n)||"")+"|  |"+(CellCycle.CellCycle.helixDisplay[System.Array.index(a,CellCycle.CellCycle.helixDisplay)].substr(n)||"");return C.current=l,i=3,!0;case 3:i=4;continue;case 4:n=n+1|0,i=1;continue;case 5:default:return!1}}catch(e){throw System.Exception.create(e)}}));return C},transcriptionAnimation:function(e){var l,t,r,n,i=0,C=new(Bridge.GeneratorEnumerator$1(System.Array.type(System.String)))(Bridge.fn.bind(this,function(){try{for(;;)switch(i){case 0:l=e.getMessengerRna().getSequence(),t=System.Array.init(9,null,System.String);for(var a=0;a<5;a=a+1|0)t[System.Array.index(a,t)]=CellCycle.CellCycle.openedDisplay[System.Array.index(a,CellCycle.CellCycle.openedDisplay)];return r=e.getSequence().length,t[System.Array.index(5,t)]="       "+String.fromCharCode(l.charCodeAt(0))+" ",t[System.Array.index(6,t)]="         ",t[System.Array.index(7,t)]="         ",t[System.Array.index(8,t)]="---------",C.current=t,i=1,!0;case 1:n=1,i=2;continue;case 2:if(n<r){i=3;continue}i=6;continue;case 3:return t[System.Array.index(5,t)]=(t[System.Array.index(5,t)]||"")+(" "+String.fromCharCode(l.charCodeAt(n))+" "||""),t[System.Array.index(6,t)]=(t[System.Array.index(6,t)]||"")+"   ",t[System.Array.index(7,t)]=(t[System.Array.index(7,t)]||"")+"   ",t[System.Array.index(8,t)]=(t[System.Array.index(8,t)]||"")+"---",n%4==3&&n<(r-1|0)&&(t[System.Array.index(5,t)]=(t[System.Array.index(5,t)]||"")+(System.String.fromCharCount(32,12)||""),t[System.Array.index(6,t)]=(t[System.Array.index(6,t)]||"")+(System.String.fromCharCount(32,12)||""),t[System.Array.index(7,t)]=(t[System.Array.index(7,t)]||"")+(System.String.fromCharCount(32,12)||""),t[System.Array.index(8,t)]=(t[System.Array.index(8,t)]||"")+(System.String.fromCharCount(45,12)||"")),C.current=t,i=4,!0;case 4:i=5;continue;case 5:n=n+1|0,i=2;continue;case 6:default:return!1}}catch(e){throw System.Exception.create(e)}}));return C},mRnaEditingAnimation:function(e,l){var t,r,n,i,C=0,a=new(Bridge.GeneratorEnumerator$1(System.Array.type(System.String)))(Bridge.fn.bind(this,function(){try{for(;;)switch(C){case 0:return t=e.getMessengerRna().getSequence(),r=Bridge.Int.mul(3,t.length)+2|0,(n=System.Array.init(4,null,System.String))[System.Array.index(0,n)]=System.String.fromCharCount(45,r),n[System.Array.index(1,n)]=System.String.fromCharCount(32,r),n[System.Array.index(2,n)]=n[System.Array.index(1,n)],n[System.Array.index(3,n)]="  "+(System.Text.RegularExpressions.Regex.replace(t,".{1}","$0  ")||""),a.current=n,C=1,!0;case 1:i=l.length-1|0,C=2;continue;case 2:if(i>=0){C=3;continue}C=6;continue;case 3:for(var y=0;y<n.length;y=y+1|0)n[System.Array.index(y,n)]=System.String.remove(n[System.Array.index(y,n)],Bridge.Int.mul(l[System.Array.index(i,l)],3),3);return a.current=n,C=4,!0;case 4:C=5;continue;case 5:i=i-1|0,C=2;continue;case 6:default:return!1}}catch(e){throw System.Exception.create(e)}}));return a},translationAnimation:function(e){var l,t,r,n,i,C,a,y=0,c=new(Bridge.GeneratorEnumerator$1(System.Array.type(System.String)))(Bridge.fn.bind(this,function(){try{for(;;)switch(y){case 0:l=e.getSequence(),e.setSequence(l.substr(0,l.length-l.length%3|0)),l=e.getSequence(),t=e.getAntiCodon(),r=System.String.split(e.getPolypeptideChain(),[45].map(function(e){return String.fromCharCode(e)})),n=System.Array.init(10,null,System.String),i=Bridge.Int.mul(11,0|Bridge.Int.div(l.length,3)),C=0|Bridge.Int.div(l.length,3),n[System.Array.index(0,n)]=System.String.fromCharCount(45,i),n[System.Array.index(1,n)]=System.String.fromCharCount(32,i),n[System.Array.index(2,n)]=n[System.Array.index(1,n)];for(var s=0;s<l.length;s=s+1|0)n[System.Array.index(3,n)]=(n[System.Array.index(3,n)]||"")+("  "+String.fromCharCode(l.charCodeAt(s))||""),n[System.Array.index(4,n)]=(n[System.Array.index(4,n)]||"")+"  |",s%3==2&&(n[System.Array.index(3,n)]=(n[System.Array.index(3,n)]||"")+"  ",n[System.Array.index(4,n)]=(n[System.Array.index(4,n)]||"")+"  ");return c.current=n,y=1,!0;case 1:a=0,y=2;continue;case 2:if(a<C){y=3;continue}y=6;continue;case 3:return n[System.Array.index(5,n)]=(n[System.Array.index(5,n)]||"")+("  "+String.fromCharCode(t.charCodeAt(Bridge.Int.mul(a,3)+0|0))+"  "+String.fromCharCode(t.charCodeAt(Bridge.Int.mul(a,3)+1|0))+"  "+String.fromCharCode(t.charCodeAt(Bridge.Int.mul(a,3)+2|0))+"  "||""),n[System.Array.index(6,n)]=(n[System.Array.index(6,n)]||"")+"  \\  |  /  ",n[System.Array.index(7,n)]=(n[System.Array.index(7,n)]||"")+"    \\ /    ",n[System.Array.index(8,n)]=(n[System.Array.index(8,n)]||"")+"     |     ",n[System.Array.index(9,n)]=(n[System.Array.index(9,n)]||"")+("    "+(r[System.Array.index(a,r)]||"")+"    "||""),Bridge.referenceEquals(r[System.Array.index(a,r)],"STOP")&&(n[System.Array.index(9,n)]=n[System.Array.index(9,n)].substr(0,n[System.Array.index(9,n)].length-1|0)),c.current=n,y=4,!0;case 4:y=5;continue;case 5:a=a+1|0,y=2;continue;case 6:default:return!1}}catch(e){throw System.Exception.create(e)}}));return c}}}}),Bridge.define("CellCycle.Cell",{fields:{dna:null},ctors:{init:function(){this.dna=new CellCycle.Dna.ctor},ctor:function(){CellCycle.Cell.$ctor1.call(this,"")},$ctor1:function(e){this.$initialize(),this.dna.setSequence(e)}},methods:{getDna:function(){return this.dna}}}),Bridge.define("CellCycle.CellCycle",{main:function(){CellCycle.CellCycle.retrieveDna(),CellCycle.CellCycle.intronPos=CellCycle.CellCycle.addIntronsToDna(),CellCycle.CellCycle.helixDisplay=CellCycle.CellCycle.getDnaHelixDisplay(CellCycle.CellCycle.mainCell.getDna()),CellCycle.CellCycle.openedDisplay=CellCycle.CellCycle.getOpenedDnaDisplay(CellCycle.CellCycle.mainCell.getDna()),CellCycle.Animations.basicAnimation(CellCycle.Animations.helicaseAnimation(CellCycle.CellCycle.mainCell.getDna()),100,2e3,function(){CellCycle.Animations.basicAnimation(CellCycle.Animations.transcriptionAnimation(CellCycle.CellCycle.mainCell.getDna()),200,2e3,function(){CellCycle.Animations.basicAnimation(CellCycle.Animations.mRnaEditingAnimation(CellCycle.CellCycle.mainCell.getDna(),CellCycle.CellCycle.intronPos),300,2e3,function(){for(var e=0;e<CellCycle.CellCycle.intronPos.length;e=e+1|0)CellCycle.CellCycle.mainCell.getDna().setSequence(System.String.remove(CellCycle.CellCycle.mainCell.getDna().getSequence(),CellCycle.CellCycle.intronPos[System.Array.index(e,CellCycle.CellCycle.intronPos)]-e|0,1));CellCycle.Animations.basicAnimation(CellCycle.Animations.translationAnimation(CellCycle.CellCycle.mainCell.getDna().getMessengerRna()),500,0,function(){})})})})},statics:{fields:{helixWidth:0,pairsPerHelix:0,rand:null,mainCell:null,intronPos:null,helixDisplay:null,openedDisplay:null},ctors:{init:function(){this.helixWidth=24,this.pairsPerHelix=4,this.rand=new System.Random.ctor,this.mainCell=new CellCycle.Cell.ctor}},methods:{retrieveDna:function(){for(;;){var e=prompt("The cell's DNA sequence: ", "TACATAGCAACT");try{if(Bridge.referenceEquals(e,""))throw new System.ArgumentOutOfRangeException.$ctor1("New DNA is empty");CellCycle.CellCycle.mainCell.getDna().setSequence(e.toUpperCase());break}catch(e){if(e=System.Exception.create(e),!Bridge.is(e,System.ArgumentOutOfRangeException))throw e;System.Console.WriteLine("Input a valid DNA sequence.")}}},addIntronsToDna:function(){for(var e=CellCycle.CellCycle.rand.Next$2(1,5),l=System.Array.init(e,0,System.Int32),t=CellCycle.CellCycle.mainCell.getDna().getSequence(),r=0;r<e;r=r+1|0)t=System.String.insert(CellCycle.CellCycle.rand.Next$2(0,t.length+1|0),t," ");for(var n=0,i=CellCycle.CellCycle.mainCell.getDna().getBases(),C=System.String.indexOf(t,String.fromCharCode(32));C>-1;C=System.String.indexOf(t,String.fromCharCode(32),C+1|0))l[System.Array.index(Bridge.identity(n,n=n+1|0),l)]=C,t=CellCycle.CellCycle.replace(t,String.fromCharCode(i[System.Array.index(CellCycle.CellCycle.rand.Next$2(0,4),i)]),C);return CellCycle.CellCycle.mainCell.getDna().setSequence(t),l},getDnaHelixDisplay:function(e){var l=e.getSequence(),t=Bridge.Int.clip32(Math.ceil(l.length/4)),r=System.Array.init(9,null,System.String);r[System.Array.index(0,r)]=(CellCycle.CellCycle.repeat("         ------         ",t)||"")+"         ---",r[System.Array.index(1,r)]=(CellCycle.CellCycle.repeat("      ---      ---      ",t)||"")+"      ---   ",r[System.Array.index(2,r)]=(CellCycle.CellCycle.repeat("   ---            ---   ",t)||"")+"   ---      ";for(var n=0;n<t;n=n+1|0)r[System.Array.index(3,r)]=(r[System.Array.index(3,r)]||"")+(" --    "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(l,Bridge.Int.mul(n,CellCycle.CellCycle.pairsPerHelix)+0|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(l,Bridge.Int.mul(n,CellCycle.CellCycle.pairsPerHelix)+1|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(l,Bridge.Int.mul(n,CellCycle.CellCycle.pairsPerHelix)+2|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(l,Bridge.Int.mul(n,CellCycle.CellCycle.pairsPerHelix)+3|0))+"    -- "||"");var i=System.String.fromCharCount(124,l.length);return r[System.Array.index(4,r)]=(CellCycle.CellCycle.repeat("-      |  |  |  |      -",t-1|0)||"")+"-      "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(i,Bridge.Int.mul(t-1|0,CellCycle.CellCycle.pairsPerHelix)+0|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(i,Bridge.Int.mul(t-1|0,CellCycle.CellCycle.pairsPerHelix)+1|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(i,Bridge.Int.mul(t-1|0,CellCycle.CellCycle.pairsPerHelix)+2|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(i,Bridge.Int.mul(t-1|0,CellCycle.CellCycle.pairsPerHelix)+3|0))+"      --           ",r[System.Array.index(5,r)]=(new System.Text.RegularExpressions.Regex.ctor(System.String.concat("[",CellCycle.CellCycle.mainCell.getDna().getBases())+"]").replace(r[System.Array.index(3,r)],function(e){return String.fromCharCode(CellCycle.Dna.baseRules.getItem(e.getValue().charCodeAt(0)))})||"")+" --         ",r[System.Array.index(3,r)]=(r[System.Array.index(3,r)]||"")+" --         ",r[System.Array.index(6,r)]=r[System.Array.index(2,r)],r[System.Array.index(7,r)]=r[System.Array.index(1,r)],r[System.Array.index(8,r)]=r[System.Array.index(0,r)],r},getOpenedDnaDisplay:function(e){var l,t,r,n=e.getSequence(),i=Bridge.Int.clip32(Math.ceil(n.length/4)),C=System.Array.init(9,null,System.String);C[System.Array.index(0,C)]=System.String.fromCharCount(45,Bridge.Int.mul(i,CellCycle.CellCycle.helixWidth)+12|0);for(var a=0;a<i;a=a+1|0)C[System.Array.index(3,C)]=(C[System.Array.index(3,C)]||"")+("       "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(n,Bridge.Int.mul(a,CellCycle.CellCycle.pairsPerHelix)+0|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(n,Bridge.Int.mul(a,CellCycle.CellCycle.pairsPerHelix)+1|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(n,Bridge.Int.mul(a,CellCycle.CellCycle.pairsPerHelix)+2|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(n,Bridge.Int.mul(a,CellCycle.CellCycle.pairsPerHelix)+3|0))+"       "||"");var y=System.String.fromCharCount(124,n.length);return C[System.Array.index(4,C)]=(CellCycle.CellCycle.repeat("       |  |  |  |       ",i-1|0)||"")+"       "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(y,Bridge.Int.mul(i-1|0,CellCycle.CellCycle.pairsPerHelix)+0|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(y,Bridge.Int.mul(i-1|0,CellCycle.CellCycle.pairsPerHelix)+1|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(y,Bridge.Int.mul(i-1|0,CellCycle.CellCycle.pairsPerHelix)+2|0))+"  "+String.fromCharCode(CellCycle.CellCycle.getSequenceIndex(y,Bridge.Int.mul(i-1|0,CellCycle.CellCycle.pairsPerHelix)+3|0))+"                   ",C[System.Array.index(5,C)]=(new System.Text.RegularExpressions.Regex.ctor(System.String.concat("[",CellCycle.CellCycle.mainCell.getDna().getBases())+"]").replace(C[System.Array.index(3,C)],function(e){return String.fromCharCode(CellCycle.Dna.baseRules.getItem(e.getValue().charCodeAt(0)))})||"")+"            ",C[System.Array.index(3,C)]=(C[System.Array.index(3,C)]||"")+"                   ",C[System.Array.index(8,C)]=C[System.Array.index(0,C)],C[System.Array.index(1,C)]=(r=System.String.fromCharCount(32,Bridge.Int.mul(i,CellCycle.CellCycle.helixWidth)+12|0),C[System.Array.index(7,C)]=r,t=r,C[System.Array.index(6,C)]=t,l=t,C[System.Array.index(2,C)]=l,l),C},getSequenceIndex:function(e,l){return l>=e.length?32:e.charCodeAt(l)},repeat:function(e,l){return System.String.concat(Bridge.toArray(System.Linq.Enumerable.repeat(e,l)))},replace:function(e,l,t){return(e.substr(0,t)||"")+(l||"")+(e.substr(t+1|0)||"")}}}}),Bridge.define("CellCycle.NucleicAcid",{fields:{sequence:null},methods:{getSequence:function(){return this.sequence},setSequence:function(e){if(null==e)throw new System.ArgumentNullException.$ctor1("New DNA is null");if(!System.Linq.Enumerable.from(e).all(Bridge.fn.bind(this,function(e){return System.Array.contains(this.getBases(),e,System.Char)})))throw new System.ArgumentOutOfRangeException.$ctor1("New DNA contains invalid characters");this.sequence=e}}}),Bridge.define("CellCycle.Dna",{inherits:[CellCycle.NucleicAcid],statics:{fields:{baseRules:null},ctors:{init:function(){var e;this.baseRules=((e=new(System.Collections.Generic.Dictionary$2(System.Char,System.Char).ctor)).add(65,84),e.add(84,65),e.add(67,71),e.add(71,67),e)}}},ctors:{ctor:function(){CellCycle.Dna.$ctor1.call(this,"")},$ctor1:function(e){this.$initialize(),CellCycle.NucleicAcid.ctor.call(this),this.setSequence(e)}},methods:{getBases:function(){return System.Array.init([65,84,67,71],System.Char)},getComplementaryDna:function(){for(var e="",l=0;l<this.sequence.length;l=l+1|0)e=(e||"")+String.fromCharCode(CellCycle.Dna.baseRules.getItem(this.sequence.charCodeAt(l)));return new CellCycle.Dna.$ctor1(e)},getMessengerRna:function(){return new CellCycle.MRna.$ctor1(System.String.replaceAll(this.getComplementaryDna().getSequence(),String.fromCharCode(84),String.fromCharCode(85)))}}}),Bridge.define("CellCycle.MRna",{inherits:[CellCycle.NucleicAcid],statics:{fields:{baseRules:null,codonChart:null},ctors:{init:function(){var e,l;this.baseRules=((e=new(System.Collections.Generic.Dictionary$2(System.Char,System.Char).ctor)).add(65,85),e.add(85,65),e.add(67,71),e.add(71,67),e),this.codonChart=((l=new(System.Collections.Generic.Dictionary$2(System.String,System.String).ctor)).add("GCA","ALA"),l.add("GCU","ALA"),l.add("GCC","ALA"),l.add("GCG","ALA"),l.add("AGG","ARG"),l.add("AGA","ARG"),l.add("CGA","ARG"),l.add("CGU","ARG"),l.add("CGC","ARG"),l.add("CGG","ARG"),l.add("AAC","ASN"),l.add("AAU","ASN"),l.add("GAC","ASP"),l.add("GAU","ASP"),l.add("UGU","CYS"),l.add("UGC","CYS"),l.add("GAG","GLU"),l.add("GAA","GLU"),l.add("CAA","GLN"),l.add("CAG","GLN"),l.add("GGA","GLY"),l.add("GGU","GLY"),l.add("GGC","GLY"),l.add("GGG","GLY"),l.add("CAC","HIS"),l.add("CAU","HIS"),l.add("AUA","ILE"),l.add("AUU","ILE"),l.add("AUC","ILE"),l.add("CUA","LEU"),l.add("CUU","LEU"),l.add("CUC","LEU"),l.add("CUG","LEU"),l.add("UUA","LEU"),l.add("UUG","LEU"),l.add("AAA","LYS"),l.add("AAG","LYS"),l.add("AUG","MET"),l.add("UUU","PHE"),l.add("UUC","PHE"),l.add("CCA","PRO"),l.add("CCU","PRO"),l.add("CCC","PRO"),l.add("CCG","PRO"),l.add("UCA","SER"),l.add("UCU","SER"),l.add("UCC","SER"),l.add("UCG","SER"),l.add("AGU","SER"),l.add("AGC","SER"),l.add("ACA","THR"),l.add("ACU","THR"),l.add("ACC","THR"),l.add("ACG","THR"),l.add("UGG","TRP"),l.add("UAU","TYR"),l.add("UAC","TYR"),l.add("GUA","VAL"),l.add("GUU","VAL"),l.add("GUC","VAL"),l.add("GUG","VAL"),l.add("UAA","STOP"),l.add("UAG","STOP"),l.add("UGA","STOP"),l)}}},ctors:{ctor:function(){CellCycle.MRna.$ctor1.call(this,"")},$ctor1:function(e){this.$initialize(),CellCycle.NucleicAcid.ctor.call(this),this.setSequence(e)}},methods:{getBases:function(){return System.Array.init([65,85,67,71],System.Char)},getAntiCodon:function(){for(var e="",l=0;l<this.sequence.length;l=l+1|0)e=(e||"")+String.fromCharCode(CellCycle.MRna.baseRules.getItem(this.sequence.charCodeAt(l)));return e},getPolypeptideChain:function(){if(Bridge.referenceEquals(this.sequence,""))return"";for(var e="",l=0;l<(0|Bridge.Int.div(this.sequence.length,3));l=l+1|0)e=(e||"")+((CellCycle.MRna.codonChart.getItem(this.sequence.substr(Bridge.Int.mul(l,3),3))||"")+"-"||"");return e=e.substr(0,e.length-1|0)}}})});